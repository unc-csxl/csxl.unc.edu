<h2 mat-dialog-title>Audit Log: {{ data.applicantName }}</h2>

<mat-dialog-content>
  @if(!(history$ | async)) {
    <div class="loading-container">
      <mat-spinner diameter="40"></mat-spinner>
    </div>
  } 
  
  @else {
    @let history = (history$ | async) ?? [];

    @if(history.length === 0) {
      <div class="empty-state">
        <p>No changes recorded.</p>
      </div>
    } @else {
      <div class="audit-list">
        @for(log of history; track log.id) {
          <div class="audit-item">
            <div class="audit-header">
              <span class="audit-user semibold">
                {{ log.changed_by_user.first_name }} {{ log.changed_by_user.last_name }}
              </span>
              <span class="audit-time text-badge secondary-background">
                {{ log.change_timestamp | date:'medium' }}
              </span>
            </div>
            <p class="audit-detail">{{ log.change_details }}</p>
            <mat-divider></mat-divider>
          </div>
        }
      </div>
    }
  }
</mat-dialog-content>

<mat-dialog-actions>
  <button mat-stroked-button color="secondary" mat-dialog-close>Close</button>
</mat-dialog-actions>