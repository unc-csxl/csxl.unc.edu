<form
  [formGroup]="eventForm"
  (ngSubmit)="onSubmit()"
  *ngIf="(adminPermission$ | async) || this.event.is_organizer">
  <mat-card>
    <mat-card-header>
      <mat-card-title *ngIf="event.id === null">Create Event</mat-card-title>
      <mat-card-title *ngIf="event.id !== null">Update Event</mat-card-title>
    </mat-card-header>
    <mat-card-content>
      <mat-form-field appearance="outline" color="accent">
        <mat-label>Event Name</mat-label>
        <input
          matInput
          placeholder="New Event"
          formControlName="name"
          name="name"
          required />
      </mat-form-field>
      <mat-form-field appearance="outline" color="accent">
        <input
          matInput
          type="datetime-local"
          placeholder="Start Time"
          formControlName="time"
          name="time"
          required />
      </mat-form-field>
      <mat-form-field appearance="outline" color="accent">
        <mat-label>Location</mat-label>
        <input
          matInput
          placeholder="The Pit"
          formControlName="location"
          name="location"
          required />
      </mat-form-field>
      <mat-form-field appearance="outline" color="accent">
        <mat-label>Description</mat-label>
        <textarea
          matInput
          placeholder="Event description here."
          formControlName="description"
          name="description"></textarea>
      </mat-form-field>
      <mat-form-field appearance="outline" color="accent">
        <mat-label>Registration Limit</mat-label>
        <input
          type="number"
          matInput
          placeholder="Registration limit here."
          formControlName="registration_limit"
          name="registration_limit" />
      </mat-form-field>
      <mat-form-field *ngIf="this.adminPermission$ | async">
        <mat-label>Organizers</mat-label>
        <mat-chip-grid #chipGrid aria-label="Choose people" required>
          <mat-chip-row
            *ngFor="let organizer of organizers"
            (removed)="onOptionDeselected(organizer)">
            <img
              *ngIf="profile!.github_avatar"
              matChipAvatar
              [src]="profile!.github_avatar" />
            {{ organizer.first_name + ' ' + organizer.last_name }}
            <button matChipRemove *ngIf="organizer.id !== organizer.id">
              <mat-icon>cancel</mat-icon>
            </button>
          </mat-chip-row>
          <input
            #organizersInput
            type="text"
            placeholder="Add more people..."
            aria-label="More people"
            [matChipInputFor]="chipGrid"
            matInput
            [matAutocomplete]="auto"
            [formControl]="userLookup" />
          <mat-autocomplete
            #auto="matAutocomplete"
            (optionSelected)="onOptionSelected($event)">
            <mat-option
              *ngFor="let option of filteredUsers$ | async"
              [value]="option">
              {{ option.first_name }} {{ option.last_name }}
            </mat-option>
          </mat-autocomplete>
        </mat-chip-grid>
      </mat-form-field>
    </mat-card-content>
    <mat-card-actions>
      <button mat-stroked-button type="submit" [disabled]="eventForm.invalid">
        SAVE
      </button>
    </mat-card-actions>
  </mat-card>
</form>

<!-- Message for Non-Authenicated Users -->
<p *ngIf="!((adminPermission$ | async) || this.event.is_organizer)">
  You do not have permission to view this page
</p>
