<mat-card appearance="outlined" class="border-transparent! max-w-full! mr-8!">
  <mat-card-header class="flex flex-col mb-4!">
    <div class="flex flex-row items-center w-full mb-4">
      <mat-card-title>Office Hours</mat-card-title>
      @if(myCoursesService.courseOverview(+courseSiteId)?.role !== 'Student') {
      <button
        mat-flat-button
        class="ml-auto"
        color="primary"
        routerLink="new/edit">
        Create Event
      </button>
      }
    </div>
    <div class="flex flex-row items-center w-full mb-4 low-button-toggle-density">
      <mat-button-toggle-group
        [(ngModel)]="viewState"
        name="view"
        class="view-toggle">
        <mat-button-toggle [value]="ViewState.Scheduled">
          Scheduled
        </mat-button-toggle>
        <mat-button-toggle [value]="ViewState.History">
          History
        </mat-button-toggle>
        <!-- <mat-button-toggle [value]="ViewState.Data">Data</mat-button-toggle> -->
      </mat-button-toggle-group>
    </div>
    <mat-divider />
  </mat-card-header>
  @if (viewState === ViewState.Scheduled) {
  <mat-card-content class="w-full!">
    <mat-card-subtitle>Happening Now</mat-card-subtitle>
    <div class="w-full flex flex-row flex-wrap gap-6 mt-4">
      @if (currentOfficeHourEvents().length === 0) {
      <p>Office hours are currently closed.</p>
      } @for (event of currentOfficeHourEvents(); track event.id) {
      <office-hour-event-card
        [event]="event"
        [editRoute]="event.id + '/edit'" />
      }
    </div>
    <mat-card-subtitle class="mt-6!">
      Future Schedule
    </mat-card-subtitle>
    @if((futureOfficeHourEventsPage()?.items ?? []).length > 0) {
    <mat-card class="max-w-full!" appearance="outlined">
      <mat-card-content class="pt-0!">
          <div class="table-responsive">
            <table
              mat-table
              [dataSource]="futureOfficeHourEventsPage()?.items ?? []">
              <ng-container matColumnDef="date">
                <th mat-header-cell *matHeaderCellDef>Date</th>
                <td mat-cell *matCellDef="let element">
                  {{ element.start_time | date: 'EEEE, M/d' }}<br />
                  {{ element.start_time | date: 'shortTime' }} -
                  {{ element.end_time | date: 'shortTime' }}
                </td>
              </ng-container>
              <ng-container matColumnDef="type">
                <th mat-header-cell *matHeaderCellDef>Type</th>
                <td mat-cell *matCellDef="let element">
                  <span class="font-medium">{{ element.type }}</span>
                  <br />
                  {{ element.location }}
                </td>
              </ng-container>
                <ng-container matColumnDef="actions">
                  <th mat-header-cell *matHeaderCellDef></th>
                  <td class="flex flex-row items-center pr-0 w-full h-[52px]" mat-cell *matCellDef="let element">
                    <div class="flex flex-row gap-[6px] ml-auto">
                      <button mat-icon-button [routerLink]="element.id + '/edit'">
                        <mat-icon class="font-secondary">edit</mat-icon>
                      </button>
                      <button mat-icon-button (click)="deleteOfficeHours(element)">
                        <mat-icon class="font-tertiary">delete</mat-icon>
                      </button>
                    </div>
                  </td>
                </ng-container>  
              <tr mat-header-row *matHeaderRowDef="futureOhDisplayedColumns"></tr>
              <tr
                mat-row
                *matRowDef="let row; columns: futureOhDisplayedColumns"></tr>
            </table>
            <mat-paginator
              [length]="futureOfficeHourEventsPage()?.length ?? 0"
              [pageSize]="futureOfficeHourEventsPage()?.params?.page_size ?? 0"
              [pageIndex]="futureOfficeHourEventsPage()?.params?.page ?? 0"
              (page)="handleFutureOfficeHoursPageEvent($event)"></mat-paginator>
          </div>
      </mat-card-content>
    </mat-card>
  } @else {
    <div class="flex flex-col py-4 gap-1">
      <p class="font-tertiary"><strong>No future office hours yet!</strong></p>
      <p>To schedule office hours, press "Create Event" at the top right of the page.</p>  
    </div>
  }
  </mat-card-content>
  } @if (viewState === ViewState.History) {
  <mat-card-content class="w-full!">
    <mat-card-subtitle>History</mat-card-subtitle>
    @if((pastOfficeHourEventsPage()?.items ?? []).length > 0) {
      <mat-card class="ml-0!" appearance="outlined">
        <mat-card-content class="pt-0!">
          <div class="table-responsive">
            <table
              mat-table
              [dataSource]="pastOfficeHourEventsPage()?.items ?? []">
              <ng-container matColumnDef="date">
                <th mat-header-cell *matHeaderCellDef>Date</th>
                <td mat-cell *matCellDef="let element">
                  {{ element.start_time | date: 'EEEE, M/d' }}<br />
                  {{ element.start_time | date: 'shortTime' }} -
                  {{ element.end_time | date: 'shortTime' }}
                </td>
              </ng-container>
              <ng-container matColumnDef="type">
                <th mat-header-cell *matHeaderCellDef>Type</th>
                <td mat-cell *matCellDef="let element">
                  <span class="font-medium">{{ element.type }}</span>
                  <br />
                  {{ element.location }}
                </td>
              </ng-container>
              <tr mat-header-row *matHeaderRowDef="pastOhDisplayedColumns"></tr>
              <tr
                mat-row
                *matRowDef="let row; columns: pastOhDisplayedColumns"></tr>
            </table>
            <mat-paginator
              [length]="pastOfficeHourEventsPage()?.length ?? 0"
              [pageSize]="pastOfficeHourEventsPage()?.params?.page_size ?? 0"
              [pageIndex]="pastOfficeHourEventsPage()?.params?.page ?? 0"
              (page)="handlePastOfficeHoursPageEvent($event)"></mat-paginator>
          </div>
        </mat-card-content>
      </mat-card>  
    } @else {
      <div class="flex flex-col py-4 gap-1">
        <p class="font-tertiary"><strong>No past office hours</strong></p>
        <p>Scheduled office hours will appear here once completed.</p>  
      </div>
    }
  </mat-card-content>
  } @if (viewState === ViewState.Data) {
  <mat-card-content class="w-full!">
    <mat-card-subtitle>More data coming soon!</mat-card-subtitle>
  </mat-card-content>
  }
</mat-card>
