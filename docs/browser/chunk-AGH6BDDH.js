import{a as We,b as et,c as tt,h as it,i as rt}from"./chunk-ZFATP7SM.js";import{a as ue,b as Ze}from"./chunk-E2O2BB5N.js";import{b as L}from"./chunk-UEXQXD4E.js";import{a as H}from"./chunk-TGRV7NB2.js";import{a as nt}from"./chunk-X5YZFMYX.js";import{a as B}from"./chunk-2NPHYAK5.js";import"./chunk-3NBKQ2M3.js";import{$a as De,$d as Fe,Aa as se,Ae as Ge,Ba as ee,Ca as te,Cd as q,Ce as Ke,Da as h,Dd as ge,Ea as a,Ed as Be,Fa as s,Fd as J,Ga as u,Gd as Y,H as W,Hb as Te,Hd as He,Id as je,Ie as de,If as Ye,Jd as Q,Je as pe,K as U,Kb as le,L as oe,Lb as Oe,Mb as Ie,N as V,Na as _,Nd as me,O as Se,P as g,Pa as f,Pb as Pe,Pf as Qe,Q as C,Qd as Ve,Ra as d,Tb as Ae,Vd as Ne,W as Re,Wb as G,Ya as Ee,Yd as Le,Za as ye,ab as c,ae as Ce,bb as P,bc as K,ca as be,cb as A,ce as $e,db as ce,de as Ue,ea as m,ec as M,hc as fe,he as Xe,ia as p,ie as he,ke as _e,la as S,ma as ae,n as ke,nf as qe,qa as Me,qb as b,r as R,rb as X,sa as N,sb as z,uf as Je,v as $,wa as w,xb as ie,xe as ze,ya as k,ye as O}from"./chunk-KVV3I3RP.js";var j=(()=>{let e=class e{constructor(t){this.http=t,this.reservationSignal=Re(void 0),this.reservation=this.reservationSignal.asReadonly()}cancel(t){let i=`/api/coworking/reservation/${t.id}`,o={id:t.id,state:"CANCELLED"};return this.http.put(i,o).pipe(R(L),W(l=>{this.reservationSignal.set(l)}))}confirm(t){let i=`/api/coworking/reservation/${t.id}`,o={id:t.id,state:"CONFIRMED"};return this.http.put(i,o).pipe(R(L),W(l=>{this.reservationSignal.set(l)}))}checkout(t){let i=`/api/coworking/reservation/${t.id}`,o={id:t.id,state:"CHECKED_OUT"};return this.http.put(i,o).pipe(R(L),W(l=>{this.reservationSignal.set(l)}))}checkin(t){let i=`/api/coworking/reservation/${t.id}`,o={id:t.id,state:"CHECKED_IN"};return this.http.put(i,o).pipe(R(L),W(l=>{this.reservationSignal.set(l)}))}getReservation(t){return this.http.get(`/api/coworking/reservation/${t}`).pipe(R(L)).subscribe(i=>{this.reservationSignal.set(i)})}getReservationObservable(t){return this.http.get(`/api/coworking/reservation/${t}`).pipe(R(L))}};e.\u0275fac=function(i){return new(i||e)(V(G))},e.\u0275prov=U({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();var I=(()=>{let e=class e extends j{constructor(t){super(t)}getNumHoursStudyRoomReservations(){return this.http.get("/api/coworking/user-reservations/")}};e.\u0275fac=function(i){return new(i||e)(V(G))},e.\u0275prov=U({token:e,factory:e.\u0275fac,providedIn:"root"});let n=e;return n})();function wt(n,e){if(n&1&&(a(0,"div",1)(1,"mat-icon"),c(2,"chair_alt"),s(),a(3,"div",2)(4,"p",3)(5,"strong"),c(6),s()()()()),n&2){let r=d();m(6),A(" ",r.reservation.seats[0].title," ")}}function kt(n,e){if(n&1&&(a(0,"p"),c(1),b(2,"date"),b(3,"date"),s()),n&2){let r=d();m(),ce(" Check-in between ",z(2,2,r.reservation.start,"shortTime")," and ",z(3,5,r.checkinDeadline(r.reservation.start,r.reservation.end),"shortTime")," to avoid cancellation. ")}}var st=(()=>{let e=class e{checkinDeadline(t,i){return new Date(Math.min(t.getTime()+600*1e3,i.getTime()))}};e.\u0275fac=function(i){return new(i||e)},e.\u0275cmp=S({type:e,selectors:[["coworking-reservation-facts"]],inputs:{reservation:"reservation"},standalone:!1,decls:27,vars:16,consts:[[1,"facts-list"],[1,"list-item"],[1,"list-item-text"],[1,"header-text"],[1,"date"]],template:function(i,o){i&1&&(a(0,"div",0)(1,"div",1)(2,"mat-icon"),c(3,"location_on"),s(),a(4,"div",2)(5,"p",3)(6,"strong"),c(7),s()()()(),w(8,wt,7,1,"div",1),a(9,"div",1)(10,"mat-icon"),c(11,"schedule"),s(),a(12,"div",2)(13,"p",3)(14,"strong"),c(15),b(16,"date"),s(),c(17," to "),a(18,"strong"),c(19),b(20,"date"),s(),a(21,"strong"),c(22),s(),a(23,"strong",4),c(24),b(25,"date"),s()(),w(26,kt,4,8,"p"),s()()()),i&2&&(m(7),P(o.reservation.room?o.reservation.room.id:"The XL Colab in Sitterson 156"),m(),k(o.reservation.seats.length>0?8:-1),m(7),P(z(16,7,o.reservation.start,"shortTime")),m(4),P(z(20,10,o.reservation.end,"shortTime")),m(3),P(", "),m(2),P(z(25,13,o.reservation.start,"dd MMM yyyy")),m(2),k(o.reservation.state==="CONFIRMED"?26:-1))},dependencies:[$e,Oe],styles:[".facts-list[_ngcontent-%COMP%]{display:flex;flex-direction:column;gap:12px;padding-top:8px;padding-bottom:8px}.header-text[_ngcontent-%COMP%]{font-size:16px;margin:0}p[_ngcontent-%COMP%]{margin-bottom:0}.list-item[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center}.list-item-text[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;margin-left:18px}.mat-icon[_ngcontent-%COMP%]{font-size:34px;min-width:34px;width:34px;height:34px}strong[_ngcontent-%COMP%]{font-weight:500}"]});let n=e;return n})();function bt(n,e){n&1&&(a(0,"mat-card-title"),c(1,"Confirm Reservation Details"),s())}function Mt(n,e){n&1&&(a(0,"div")(1,"mat-card-title"),c(2,"Check-In at the Front Desk"),s(),a(3,"p"),c(4,"See the XL Ambassador staffing the front desk to check-in."),s()())}function Et(n,e){if(n&1&&w(0,Mt,5,0,"div"),n&2){let r=d();k(r.reservation.room?-1:0)}}function yt(n,e){n&1&&(a(0,"div")(1,"mat-card-title"),c(2,"You're Checked In!"),s(),a(3,"p"),c(4," See the XL Ambassador if you need anything. When you're done, just press the Check Out button or check out with the XL Ambassador. "),u(5,"br")(6,"br"),a(7,"i"),c(8,"Changing seats? Please check out and check back in."),s()()())}function Dt(n,e){n&1&&(a(0,"div")(1,"mat-card-title"),c(2,"Thanks for visiting!"),s(),a(3,"p"),c(4,"You're all checked out."),s()())}function Tt(n,e){n&1&&(a(0,"mat-card-title"),c(1,"Reservation Cancelled"),s())}function Ot(n,e){if(n&1){let r=_();a(0,"button",5),f("click",function(){g(r);let i=d();return C(i.cancel())}),c(1," Cancel "),s(),a(2,"button",6),f("click",function(){g(r);let i=d();return C(i.confirm())}),c(3),b(4,"async"),s()}if(n&2){let r=d();m(3),A(" ",X(4,1,r.draftConfirmationDeadline$)," ")}}function It(n,e){if(n&1){let r=_();a(0,"button",7),f("click",function(){g(r);let i=d(2);return C(i.checkin())}),c(1," Check In "),s()}}function Pt(n,e){if(n&1){let r=_();a(0,"button",5),f("click",function(){g(r);let i=d();return C(i.cancel())}),c(1," Cancel "),s(),w(2,It,2,0,"button",4)}if(n&2){let r=d();m(2),k(r.checkCheckinAllowed()&&r.reservation.room?2:-1)}}function At(n,e){if(n&1){let r=_();a(0,"button",5),f("click",function(){g(r);let i=d();return C(i.checkout())}),c(1," Check Out "),s()}}function Bt(n,e){if(n&1){let r=_();a(0,"button",7),f("click",function(){g(r);let i=d();return C(i.refreshCoworkingHome())}),c(1," Return to Coworking Home "),s()}}function Ht(n,e){if(n&1){let r=_();a(0,"button",7),f("click",function(){g(r);let i=d();return C(i.refreshCoworkingHome())}),c(1," Return to Coworking Home "),s()}}var Z=(()=>{let e=class e{constructor(t,i,o,l){this.router=t,this.roomReservationService=i,this.snackBar=o,this.coworkingService=l,this.isPane=!0,this.updateReservationsList=new N,this.isConfirmed=new N,this.updateActiveReservation=new N,this.reloadCoworkingHome=new N,this.isCancelExpanded$=this.coworkingService.isCancelExpanded.asObservable()}ngOnInit(){this.draftConfirmationDeadline$=this.initDraftConfirmationDeadline()}checkinDeadline(t,i){return new Date(Math.min(t.getTime()+600*1e3,i.getTime()))}cancel(){this.roomReservationService.cancel(this.reservation).subscribe({next:()=>{this.refreshCoworkingHome()},error:t=>{this.snackBar.open("Error: Issue cancelling reservation. Please see CSXL Ambassador for assistance.","",{duration:8e3}),console.error(t.message)}})}confirm(){this.isConfirmed.emit(!0),this.roomReservationService.confirm(this.reservation).subscribe({next:()=>{this.refreshCoworkingHome()},error:t=>{this.snackBar.open("Error: Issue confirming reservation. Please see CSXL Ambassador for assistance.","",{duration:8e3}),console.error(t.message)}})}checkout(){this.roomReservationService.checkout(this.reservation).subscribe({next:()=>this.refreshCoworkingHome(),error:t=>{this.snackBar.open("Error: Issue checking out reservation. Please see CSXL Ambassador for assistance.","",{duration:8e3}),console.error(t.message)}})}checkin(){this.roomReservationService.checkin(this.reservation).subscribe({next:()=>{this.refreshCoworkingHome()},error:t=>{this.snackBar.open("Error: Issue cancelling reservation. Please see CSXL Ambassador for assistance.","",{duration:8e3})}})}initDraftConfirmationDeadline(){let i=l=>new Date(l.created_at).getTime()+3e5,o=l=>{let x=new Date().getTime(),D=(l-x)/1e3;return D>60?`Confirm in ${Math.ceil(D/60)} minutes`:D>0?`Confirm in ${Math.ceil(D)} seconds`:(this.cancel(),"Cancelling...")};return $(0,1e3).pipe(R(()=>this.reservation),R(i),R(o))}refreshCoworkingHome(){this.reloadCoworkingHome.emit(),this.router.navigateByUrl("/coworking")}checkCheckinAllowed(){let t=new Date;return new Date(this.reservation.start)<=t&&t<=new Date(this.reservation.end)}toggleCancelExpansion(){this.coworkingService.toggleCancelExpansion()}isExpandedOrAllowCheckin(){return this.isCancelExpanded$.pipe(R(t=>t||this.checkCheckinAllowed()))}};e.\u0275fac=function(i){return new(i||e)(p(M),p(I),p(O),p(ue))},e.\u0275cmp=S({type:e,selectors:[["coworking-reservation-card"]],inputs:{reservation:"reservation",isPane:"isPane"},outputs:{updateReservationsList:"updateReservationsList",isConfirmed:"isConfirmed",updateActiveReservation:"updateActiveReservation",reloadCoworkingHome:"reloadCoworkingHome"},standalone:!1,decls:16,vars:5,consts:[["appearance","outlined"],[1,"divider"],[3,"reservation"],["mat-flat-button","","type","submit",1,"tertiary-button"],["mat-stroked-button","","type","submit","color","primary"],["mat-flat-button","","type","submit",1,"tertiary-button",3,"click"],["mat-flat-button","","type","submit",1,"action-button",3,"click"],["mat-stroked-button","","type","submit","color","primary",3,"click"]],template:function(i,o){if(i&1&&(a(0,"mat-card",0)(1,"mat-card-header"),w(2,bt,2,0,"mat-card-title")(3,Et,1,1)(4,yt,9,0,"div")(5,Dt,5,0,"div")(6,Tt,2,0,"mat-card-title"),s(),u(7,"div",1),a(8,"mat-card-content"),u(9,"coworking-reservation-facts",2),s(),a(10,"mat-card-actions"),w(11,Ot,5,3)(12,Pt,3,1)(13,At,2,0,"button",3)(14,Bt,2,0,"button",4)(15,Ht,2,0,"button",4),s()()),i&2){let l,x;De(o.isPane?"pane":""),m(2),k((l=o.reservation.state)==="DRAFT"?2:l==="CONFIRMED"?3:l==="CHECKED_IN"?4:l==="CHECKED_OUT"?5:l==="CANCELLED"?6:-1),m(7),h("reservation",o.reservation),m(2),k((x=o.reservation.state)==="DRAFT"?11:x==="CONFIRMED"?12:x==="CHECKED_IN"?13:x==="CHECKED_OUT"?14:x==="CANCELLED"?15:-1)}},dependencies:[Be,je,Y,Q,J,q,st,le],styles:[".pane{border-color:transparent!important}.mat-mdc-card-actions[_ngcontent-%COMP%]{padding-bottom:16px;justify-content:end;gap:12px}@media only screen and (max-width: 640px){.mat-mdc-card-actions[_ngcontent-%COMP%]{flex-direction:column;padding-bottom:16px;align-items:start;gap:12px}}"]});let n=e;return n})();function Nt(n,e){if(n&1&&(a(0,"mat-pane"),u(1,"coworking-operating-hours-panel",5),s()),n&2){let r=d(2);m(),h("operatingHours",r.status().operating_hours)("openOperatingHours",r.openOperatingHours())}}function Lt(n,e){if(n&1&&(a(0,"mat-pane"),u(1,"coworking-operating-hours-panel",6),s()),n&2){let r=d(2);m(),h("operatingHours",r.status().operating_hours)}}function Ft(n,e){if(n&1){let r=_();a(0,"coworking-reservation-card",7),f("reloadCoworkingHome",function(){g(r);let i=d(2);return C(i.ngOnInit())}),s()}if(n&2){let r=d(2);h("reservation",r.activeReservation())}}function $t(n,e){if(n&1){let r=_();a(0,"coworking-dropin-availability-card",8),f("seatsSelected",function(i){g(r);let o=d(2);return C(o.reserve(i))}),s()}if(n&2){let r=d(2);h("seat_availability",r.status().seat_availability)}}function Ut(n,e){if(n&1){let r=_();w(0,Nt,2,2,"mat-pane")(1,Lt,2,1,"mat-pane"),w(2,Ft,1,1,"coworking-reservation-card",0)(3,$t,1,1,"coworking-dropin-availability-card",1),a(4,"mat-pane")(5,"div",2)(6,"div",3)(7,"mat-card-title"),c(8,"Reserve a Room"),s(),a(9,"p"),c(10,"Reserve a room in the XL hallway!"),s()(),a(11,"button",4),f("click",function(){g(r);let i=d();return C(i.navigateToNewReservation())}),c(12," View "),s()()()}if(n&2){let r=d();k(r.openOperatingHours()?0:1),m(2),k(r.activeReservation()?2:3)}}function Xt(n,e){if(n&1){let r=_();a(0,"coworking-reservation-card",10),f("reloadCoworkingHome",function(){g(r);let i=d(2);return C(i.ngOnInit())}),s()}if(n&2){let r=e.$implicit;h("reservation",r)("isPane",!1)}}function zt(n,e){if(n&1&&(a(0,"mat-pane")(1,"mat-card-header")(2,"mat-card-title"),c(3,"Upcoming Room Reservations"),s()(),a(4,"mat-card-content"),ee(5,Xt,1,2,"coworking-reservation-card",9,se),s()()),n&2){let r=d();m(5),te(r.upcomingReservations())}}var mt=(()=>{let e=class e{constructor(t,i,o,l,x,D,ht,_t){this.coworkingService=t,this.router=i,this.route=o,this.reservationService=l,this.snackBar=x,this.roomReservationService=D,this.profileService=ht,this.dialog=_t,this.profile=null,this.openOperatingHours=ie(()=>{let F=new Date;return this.status().operating_hours.find(T=>T.start<=F)}),this.upcomingReservations=ie(()=>{let F=T=>!this.coworkingService.findActiveReservationPredicate(T)&&T&&T.room&&T.state==="CONFIRMED";return this.status().my_reservations.filter(F)}),this.isOpen=ie(()=>{let F=new Date,T=this.openOperatingHours();return T&&T.start<=F&&T.end>F}),this.activeReservation=ie(()=>this.status().my_reservations.find(this.coworkingService.findActiveReservationPredicate)),this.status=t.status;let xt=this.route.snapshot.data;this.profile=xt.profile}ngOnInit(){this.status=this.coworkingService.status,this.timerSubscription=$(0,1e4).subscribe(()=>{this.coworkingService.pollStatus()})}ngOnDestroy(){this.timerSubscription.unsubscribe()}reserve(t){this.coworkingService.draftReservation(t).subscribe({error:i=>{this.snackBar.open(i.error.message,"",{duration:8e3})},next:i=>{this.router.navigateByUrl(`/coworking/reservation/${i.id}`)}})}navigateToNewReservation(){this.router.navigateByUrl("/coworking/new-reservation")}};e.Route={path:"",component:e,title:"Coworking",canActivate:[H],resolve:{profile:B}},e.\u0275fac=function(i){return new(i||e)(p(ue),p(M),p(K),p(j),p(O),p(I),p(de),p(Ve))},e.\u0275cmp=S({type:e,selectors:[["app-coworking-home"]],standalone:!1,decls:2,vars:2,consts:[[3,"reservation"],[3,"seat_availability"],[1,"reserve-room-content"],[1,"reserve-room-text"],["id","new-room-reservation-button","mat-stroked-button","","type","submit","color","primary",3,"click"],[3,"operatingHours","openOperatingHours"],[3,"operatingHours"],[3,"reloadCoworkingHome","reservation"],[3,"seatsSelected","seat_availability"],[3,"reservation","isPane"],[3,"reloadCoworkingHome","reservation","isPane"]],template:function(i,o){i&1&&(w(0,Ut,13,2),w(1,zt,7,0,"mat-pane")),i&2&&(k(o.status()?0:-1),m(),k(o.upcomingReservations().length>0?1:-1))},dependencies:[Y,Q,J,q,pe,Ye,Ze,Z],styles:[".reserve-room-content[_ngcontent-%COMP%]{display:flex;flex-direction:row;align-items:center;margin-top:16px;margin-bottom:16px}.reserve-room-text[_ngcontent-%COMP%]{display:flex;flex-direction:column;justify-content:center;margin-left:16px}.reserve-room-text[_ngcontent-%COMP%]   p[_ngcontent-%COMP%]{margin-bottom:0}#new-room-reservation-button[_ngcontent-%COMP%]{margin-left:auto;margin-right:16px}"]});let n=e;return n})();function Gt(n,e){if(n&1&&u(0,"coworking-reservation-card",1),n&2){let r=d();h("reservation",r.reservationService.reservation())}}var Kt=n=>{let e=Se(j),r=t=>`Reservation #${t.id}`;return e.getReservationObservable(parseInt(n.params.id)).pipe(R(r))},dt=(()=>{let e=class e{constructor(t,i,o){this.route=t,this.reservationService=i,this.router=o;let l=parseInt(t.snapshot.params.id);i.getReservation(l)}};e.Route={path:"reservation/:id",component:e,title:Kt,canActivate:[H],resolve:{profile:B}},e.\u0275fac=function(i){return new(i||e)(p(K),p(j),p(M))},e.\u0275cmp=S({type:e,selectors:[["app-coworking-reservation"]],standalone:!1,decls:2,vars:1,consts:[[1,"card-container"],[3,"reservation"]],template:function(i,o){i&1&&(a(0,"div",0),w(1,Gt,1,1,"coworking-reservation-card",1),s()),i&2&&(m(),k(o.reservationService.reservation()?1:-1))},dependencies:[Z],styles:[".card-container[_ngcontent-%COMP%]{margin:16px}.mat-mdc-card[_ngcontent-%COMP%]{max-width:640px;margin:0}.mat-mdc-card-header[_ngcontent-%COMP%]{margin-bottom:16px}.mat-mdc-card-actions[_ngcontent-%COMP%]{margin-top:16px}.mat-divider[_ngcontent-%COMP%]{margin:1em 0}h3[_ngcontent-%COMP%]{font-size:18px;margin-bottom:0}h3[_ngcontent-%COMP%] > label[_ngcontent-%COMP%]{width:64px;display:inline-block}p[_ngcontent-%COMP%]{margin-left:64px}"]});let n=e;return n})();var v=class v{constructor(e,r){this.http=e,this.profileSvc=r,this.selectedDateSubject=new ke(""),this.selectedDate$=this.selectedDateSubject.asObservable(),this.EndingOperationalHour=18,this.profileSubscription=this.profileSvc.profile$.subscribe(t=>this.profile=t)}setSelectedDate(e){this.selectedDateSubject.next(e)}getReservationsForRoomsByDate(e){let r=new Ae().set("date",e.toISOString());return this.http.get("/api/coworking/room-reservation/",{params:r})}draftReservation(e,r){let t=this._findSelectedRoom(e);if(!t)throw new Error("No room selected");let i=this._makeReservationRequest(t,r);return this.makeDraftReservation(i)}makeDraftReservation(e){return this.http.post("/api/coworking/reservation",e)}deselectCell(e,r,t){t.setSlotAvailable(e,r),t.selectedCells=t.selectedCells.filter(o=>!(o.key===e&&o.index===r)),this._areAllAdjacent(t.selectedCells)||(t.selectedCells=this._updateAdjacentCells(r,t))}selectCell(e,r,t){t.selectedCells.some(o=>Math.abs(r-o.index)<=1&&e===o.key)&&t.selectedCells.length<v.MAX_RESERVATION_CELL_LENGTH?(t.setSlotReserving(e,r),t.selectedCells.push({key:e,index:r})):t.selectedCells.length>=v.MAX_RESERVATION_CELL_LENGTH?(this._setAllAvailable(t),t.selectedCells=[{key:e,index:r}],t.setSlotReserving(e,r)):(this._setAllAvailable(t),t.selectedCells=[{key:e,index:r}],t.setSlotReserving(e,r))}_findSelectedRoom(e){let r=Object.entries(e).find(([t,i])=>i.includes(v.CellEnum.RESERVING));return r?{room:r[0],availability:r[1]}:null}_makeReservationRequest(e,r){let t=e?.availability.indexOf(v.CellEnum.RESERVING),i=e?.availability.lastIndexOf(v.CellEnum.RESERVING),o=1800*1e3,l=new Date(r.getTime()+o*t),x=new Date(r.getTime()+o*(i+1));return{users:[this.profile],seats:[],room:{id:e.room},start:l,end:x}}_setAllAvailable(e){e.selectedCells.forEach(r=>{e.setSlotAvailable(r.key,r.index)})}_areAllAdjacent(e){return e.every((r,t)=>{if(t<e.length-1){let i=e[t+1];return Math.abs(r.index-i.index)<=1}return!0})}_updateAdjacentCells(e,r){let t=this._countIfOnLeft(e,r.selectedCells),i=r.selectedCells.length-t;return this._filterCellsBasedOnIndex(r,e,t<i)}_filterCellsBasedOnIndex(e,r,t){return e.selectedCells.filter(i=>t&&i.index<r?(e.setSlotAvailable(i.key,i.index),!1):!t&&i.index>r?(e.reservationsMap[i.key][i.index]=v.CellEnum.AVAILABLE,!1):!0)??[]}_countIfOnLeft(e,r){return r.reduce((t,i)=>i.index<e?t+=1:t,0)}setMaxDate(){let e=new Date;return e.setDate(e.getDate()+7),e}setMinDate(){let e=new Date;return e.getHours()>=this.EndingOperationalHour&&e.setDate(e.getDate()+1),e}formatAMPM(e){let r=e.getHours(),t=e.getMinutes(),i=r>=12?"PM":"AM";r=r%12,r=r||12;let o=t<10?"0"+t:t.toString();return`${r}:${o}${i}`}generateTimeSlots(e,r,t){let i=[];for(;e<r;){let l=new Date(e.getTime()+18e5);i.push(`${this.formatAMPM(e)} <br> to <br> ${this.formatAMPM(l)}`),e=l}return i}};v.MAX_RESERVATION_CELL_LENGTH=4,v.CellEnum={AVAILABLE:0,BOOKED:1,RESERVING:2,UNAVAILABLE:3,SUBJECT_RESERVATION:4},v.CellPropertyMap={[v.CellEnum.AVAILABLE]:{backgroundColor:"#03691e",isDisabled:!1},[v.CellEnum.BOOKED]:{backgroundColor:"#B3261E",isDisabled:!0},[v.CellEnum.RESERVING]:{backgroundColor:"orange",isDisabled:!1},[v.CellEnum.UNAVAILABLE]:{backgroundColor:"#4d4d4d",isDisabled:!0},[v.CellEnum.SUBJECT_RESERVATION]:{backgroundColor:"#3479be",isDisabled:!0}},v.\u0275fac=function(r){return new(r||v)(V(G),V(de))},v.\u0275prov=U({token:v,factory:v.\u0275fac,providedIn:"root"});var y=v;var qt=(n,e)=>e.key;function Jt(n,e){if(n&1&&u(0,"th",3),n&2){let r=e.$implicit;h("innerHTML",r,be)}}function Yt(n,e){if(n&1){let r=_();a(0,"td",8),f("click",function(){let i=g(r),o=i.$implicit,l=i.index,x=d().$implicit,D=d();return C(!D.cellPropertyMap[o].isDisabled&&D.toggleCellColor(x.key,l))}),s()}if(n&2){let r=e.$implicit,t=d(2);ye("background",t.cellPropertyMap[r].backgroundColor)}}function Qt(n,e){if(n&1&&(a(0,"tr")(1,"th"),c(2),u(3,"br"),a(4,"span",6),c(5),u(6,"br"),c(7),s()(),Me(8,Yt,1,2,"td",7),s()),n&2){let r=e.$implicit,t=d();m(2),A("",r.key," "),m(3),ce(" ","# seats: ","",t.capacityMap[r.key]," "),m(2),P(t.roomTypeMap[r.key]),m(),h("ngForOf",r.value)}}var ut=(()=>{let e=class e{constructor(t,i,o,l){this.reservationTableService=t,this.router=i,this.roomReservationService=o,this.snackBar=l,this.timeSlots=[],this.reservationsMap={},this.capacityMap={},this.roomTypeMap={},this.selectButton=!1,this.operationStart=new Date,this.selectedDate="",this.cellPropertyMap=y.CellPropertyMap,this.snackBarOptions={duration:8e3},this.selectedCells=[],this.reservationTableService.setSelectedDate(this.reservationTableService.setMinDate().toDateString()),this.subscription=this.reservationTableService.selectedDate$.subscribe(x=>{this.selectedDate=x,this.getReservationsByDate(new Date(x))})}getReservationsByDate(t){this.reservationTableService.getReservationsForRoomsByDate(t).subscribe(i=>{this.reservationsMap=i.reserved_date_map,this.capacityMap=i.capacity_map,this.roomTypeMap=i.room_type_map;let o=new Date(i.operating_hours_end);this.operationStart=new Date(i.operating_hours_start);let l=i.number_of_time_slots;this.timeSlots=this.reservationTableService.generateTimeSlots(this.operationStart,o,l)},i=>{this.snackBar.open("Error fetching reservations","Close",this.snackBarOptions),console.error("Error fetching reservations:",i)})}toggleCellColor(t,i){this.reservationsMap[t][i]===y.CellEnum.RESERVING?this.reservationTableService.deselectCell(t,i,this):this.reservationTableService.selectCell(t,i,this),this.selectButtonToggle()}selectButtonToggle(){this.selectButton=Object.values(this.reservationsMap).some(t=>t.includes(y.CellEnum.RESERVING))}draftReservation(){this.reservationTableService.draftReservation(this.reservationsMap,this.operationStart).subscribe(i=>{this.router.navigateByUrl(`/coworking/confirm-reservation/${i.id}`)},i=>{console.error("Error drafting reservation",i),this.snackBar.open(i.error.message,"Close",this.snackBarOptions)})}setSlotReserving(t,i){this.reservationsMap[t][i]=y.CellEnum.RESERVING}setSlotAvailable(t,i){this.reservationsMap[t][i]=y.CellEnum.AVAILABLE}};e.\u0275fac=function(i){return new(i||e)(p(y),p(M),p(I),p(O))},e.\u0275cmp=S({type:e,selectors:[["room-reservation-table"]],standalone:!1,decls:13,vars:3,consts:[[1,"table-container"],[1,"table-responsive"],[1,"table"],[1,"time-slot",3,"innerHTML"],[1,"divider"],["mat-stroked-button","",1,"button",3,"click","disabled"],[1,"room-details"],[3,"background","click",4,"ngFor","ngForOf"],[3,"click"]],template:function(i,o){i&1&&(a(0,"div",0)(1,"div",1)(2,"table",2)(3,"tr"),u(4,"th"),ee(5,Jt,1,1,"th",3,se),s(),ee(7,Qt,9,5,"tr",null,qt),b(9,"keyvalue"),s()()(),a(10,"div",4)(11,"button",5),f("click",function(){return o.draftReservation()}),c(12," Reserve "),s()()),i&2&&(m(5),te(o.timeSlots),m(2),te(X(9,1,o.reservationsMap)),m(4),h("disabled",!o.selectButton))},dependencies:[Te,q,Ie],styles:[".table-container[_ngcontent-%COMP%]{overflow-x:auto;max-width:100%}table[_ngcontent-%COMP%]{border-collapse:collapse;width:99%;margin-left:10px;white-space:nowrap}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{border:1px solid #ddd;padding:10px;text-align:center}th[_ngcontent-%COMP%], td[_ngcontent-%COMP%]{height:40px;width:30px}.time-slot[_ngcontent-%COMP%]{font-size:12px}.button[_ngcontent-%COMP%]{margin-top:20px;font-size:16px;padding:10px 20px;margin-left:10px}.divider[_ngcontent-%COMP%]{margin-bottom:1em}.room-details[_ngcontent-%COMP%]{font-size:smaller;font-weight:lighter}"]});let n=e;return n})();var vt=(()=>{let e=class e{constructor(t){this.reservationTableService=t,this.dateSelected=new N,this.minDate=this.reservationTableService.setMinDate(),this.maxDate=this.reservationTableService.setMaxDate()}onDateChange(t){let i=this.formatDate(t.value);this.reservationTableService.setSelectedDate(i)}formatDate(t){return t.toLocaleDateString()}};e.\u0275fac=function(i){return new(i||e)(p(y))},e.\u0275cmp=S({type:e,selectors:[["date-selector"]],outputs:{dateSelected:"dateSelected"},standalone:!1,decls:5,vars:5,consts:[["picker",""],["appearance","outline","subscriptSizing","dynamic"],["matInput","",3,"dateChange","matDatepicker","value","min","max"],["matSuffix","",3,"for"]],template:function(i,o){if(i&1){let l=_();a(0,"mat-form-field",1)(1,"input",2),f("dateChange",function(D){return g(l),C(o.onDateChange(D))}),s(),u(2,"mat-datepicker-toggle",3)(3,"mat-datepicker",null,0),s()}if(i&2){let l=Ee(4);m(),h("matDatepicker",l)("value",o.minDate)("min",o.minDate)("max",o.maxDate),m(),h("for",l)}},dependencies:[Fe,Le,Xe,We,et,tt],encapsulation:2});let n=e;return n})();var ft=(()=>{let e=class e{constructor(t,i,o){this.router=t,this.roomReservationService=i,this.snackBar=o}ngOnInit(){this.getNumHoursStudyRoomReservations()}navigateToNewReservation(){this.router.navigateByUrl("/coworking/new-reservation")}getNumHoursStudyRoomReservations(){this.numHoursStudyRoomReservations$=this.roomReservationService.getNumHoursStudyRoomReservations()}};e.Route={path:"new-reservation",title:"New Reservation",component:e,canActivate:[H],resolve:{profile:B}},e.\u0275fac=function(i){return new(i||e)(p(M),p(I),p(O))},e.\u0275cmp=S({type:e,selectors:[["app-new-reservation-page"]],standalone:!1,decls:32,vars:3,consts:[[1,"date-selector"],[1,"horizontal-scroll"],[1,"legend-container"],[1,"legend-item"],[1,"legend-color",2,"background-color","#03691e"],[1,"legend-text"],[1,"legend-color",2,"background-color","#B3261E"],[1,"legend-color",2,"background-color","#3479be"],[1,"legend-color",2,"background-color","orange"],[1,"legend-color",2,"background-color","#4d4d4d"]],template:function(i,o){i&1&&(a(0,"mat-pane")(1,"mat-card-header")(2,"mat-card-title"),c(3,"Reserve a Room"),s(),a(4,"mat-card-subtitle"),c(5),b(6,"async"),s(),a(7,"div",0),u(8,"date-selector"),s()(),a(9,"mat-card-content"),u(10,"room-reservation-table",1),a(11,"div",2)(12,"div",3),u(13,"div",4),a(14,"span",5),c(15,"Available"),s()(),a(16,"div",3),u(17,"div",6),a(18,"span",5),c(19,"Reserved"),s()(),a(20,"div",3),u(21,"div",7),a(22,"span",5),c(23,"Your Reservations"),s()(),a(24,"div",3),u(25,"div",8),a(26,"span",5),c(27,"Selected"),s()(),a(28,"div",3),u(29,"div",9),a(30,"span",5),c(31,"Unavailable"),s()()()()()),i&2&&(m(5),A("Total Hours Remaining: ",X(6,1,o.numHoursStudyRoomReservations$)))},dependencies:[Y,Q,He,J,pe,ut,vt,le],styles:[".mat-mdc-card-outlined{max-width:100%!important;margin-right:32px!important}.mat-mdc-card-header[_ngcontent-%COMP%]{display:flex;justify-content:space-between;align-items:center;margin-bottom:12px}.mat-mdc-card-title[_ngcontent-%COMP%], .mat-mdc-card-subtitle[_ngcontent-%COMP%]{padding-left:10px}.date-selector[_ngcontent-%COMP%]{padding:10px}.upcoming-reservations-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;gap:20px}.coworking-reservation-card[_ngcontent-%COMP%]{width:calc(50% - 10px);margin-bottom:20px;box-sizing:border-box}.heading[_ngcontent-%COMP%]{padding-top:30px;padding-left:10px}.legend-container[_ngcontent-%COMP%]{display:flex;flex-wrap:wrap;margin-top:20px}.legend-item[_ngcontent-%COMP%]{display:flex;align-items:center;margin-left:10px;margin-top:5px}.legend-color[_ngcontent-%COMP%]{width:20px;height:20px;margin-right:5px;border-radius:6px}.legend-text[_ngcontent-%COMP%]{font-size:14px}.reservation-limit[_ngcontent-%COMP%]{padding-left:10px}@media only screen and (max-width: 900px){.mat-mdc-card-header[_ngcontent-%COMP%]{flex-direction:column;align-items:baseline}}"]});let n=e;return n})();function ei(n,e){if(n&1){let r=_();a(0,"coworking-reservation-card",2),f("isConfirmed",function(i){g(r);let o=d();return C(o.setConfirmation(i))}),s()}if(n&2){let r=d();h("reservation",r.reservation)}}var gt=(()=>{let e=class e{constructor(t,i,o,l){this.roomReservationService=t,this.snackBar=i,this.router=o,this.route=l,this.reservation=null,this.isConfirmed=!1,this.id=parseInt(this.route.snapshot.params.id)}ngOnDestroy(){this.isConfirmed||this.roomReservationService.cancel(this.reservation).subscribe()}ngOnInit(){this.roomReservationService.getReservationObservable(this.id).subscribe({next:t=>this.reservation=t,error:t=>{this.snackBar.open("Error while fetching draft reservation.","",{duration:8e3}),$(3e3).subscribe(()=>this.router.navigateByUrl("/coworking/new-reservation")),console.error(t.message)}})}setConfirmation(t){this.isConfirmed=t}};e.Route={path:"confirm-reservation/:id",title:"Confirm Reservation",component:e,canActivate:[H],resolve:{profile:B}},e.\u0275fac=function(i){return new(i||e)(p(I),p(O),p(M),p(K))},e.\u0275cmp=S({type:e,selectors:[["app-confirm-reservation"]],standalone:!1,decls:2,vars:1,consts:[[1,"card-container"],[3,"reservation"],[3,"isConfirmed","reservation"]],template:function(i,o){i&1&&(a(0,"div",0),w(1,ei,1,1,"coworking-reservation-card",1),s()),i&2&&(m(),k(o.reservation?1:-1))},dependencies:[Z],styles:[".card-container[_ngcontent-%COMP%]{margin:16px}.mat-mdc-card[_ngcontent-%COMP%]{max-width:640px;margin:0}.mat-mdc-card-header[_ngcontent-%COMP%]{margin-bottom:16px}.mat-mdc-card-actions[_ngcontent-%COMP%]{margin-top:16px}.mat-divider[_ngcontent-%COMP%]{margin:1em 0}h3[_ngcontent-%COMP%]{font-size:18px;margin-bottom:0}h3[_ngcontent-%COMP%] > label[_ngcontent-%COMP%]{width:64px;display:inline-block}p[_ngcontent-%COMP%]{margin-left:64px}"]});let n=e;return n})();var ti=[mt.Route,dt.Route,ft.Route,gt.Route,{path:"ambassador",title:"Ambassador",loadChildren:()=>import("./chunk-VEHCDRR6.js").then(n=>n.AmbassadorHomeModule)}],Ct=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=ae({type:e}),e.\u0275inj=oe({imports:[fe.forChild(ti),fe]});let n=e;return n})();var Un=(()=>{let e=class e{};e.\u0275fac=function(i){return new(i||e)},e.\u0275mod=ae({type:e}),e.\u0275inj=oe({imports:[Pe,me,ge,_e,Ue,Ct,me,_e,ze,nt,ge,qe,Ce,he,Je,me,Qe,it,he,rt,Ce,Ke,Ge,Ne]});let n=e;return n})();export{Un as CoworkingModule};
